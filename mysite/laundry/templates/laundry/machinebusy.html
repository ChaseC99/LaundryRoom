<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>LAUNDRY ROOM</title>
        <link rel="stylesheet" type="text/css" href="machinebusy.css">
        <link rel="icon" href="img/mena_machine.png">
        <script lang="javascript" src="laundry.js"></script>
	</head>
    <body>
        <div class="container-fluid">
            <h2 style="text-align: center;">Machine is used by <br> [User Form] <br> [User Email] </h2>

            <h3 style="text-align: center;">Time Remaining</h3>
            <h4 style="text-align: center;">for machine number 
                <script>
                        document.write(findMachineId());
                </script></h4>
            <div id="clockdiv" style="margin-top: 100px;">
              <div>
                <span id="minutes"></span>
                <div class="smalltext">Minutes</div>
              </div>
              <div>
                <span id="seconds"></span>
                <div class="smalltext">Seconds</div>
              </div>
            <p><img src="img/mena_spinning.gif" alt="mena"></p>
            </div>
        </div>
            
        <script>
            request = new XMLHttpRequest();
            url = "http://169.234.81.18:8000/api/machine_info/" + findMachineId();

            request.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var machine_info = JSON.parse(this.responseText);

                    end_time = machine_info["start_time"] + machine_info["duration"]*60*1000;
                    current_time = + new Date();
                    
                    time_till_done = (end_time - current_time)/1000;
                    
                    startTimer(time_till_done);
                }
            };

            request.open("GET", url, true);
            request.send();
        </script>
      </body>
</html>
